# 員工考勤系統 (Google Apps Script 版) 使用手冊

本專案是一個輕量級的員工打卡系統，資料直接儲存在 Google 試算表中，介面友善且支援 PDF 匯出。

## 一、 Google Sheets 資料庫設定

本系統使用 Google 試算表作為資料庫。

1. **建立試算表**：
   - 前往 [Google Sheets](https://docs.google.com/spreadsheets/) 建立一個新的空白試算表。
   - 建議命名為：「**2023 員工考勤紀錄**」。

2. **欄位安排**：
   - 系統會在第一次執行時**自動**建立標題列，您不需要手動輸入。
   - 若要手動建立，請在 **第一列 (Row 1)** 依序輸入以下標題：
     - `Column A`: **姓名**
     - `Column B`: **日期**
     - `Column C`: **簽到時間**
     - `Column D`: **簽退時間**
     - `Column E`: **備註**
   - **請勿更改欄位順序**，否則程式讀寫會錯位。

## 二、 程式安裝步驟

### 1. 開啟指令碼編輯器
   - 在您的 Google 試算表中，點選上方選單：`擴充功能` > `Apps Script`。

### 2. 貼上程式碼
   本專案有兩個主要檔案，請分別建立並貼上程式碼：

   - **`Code.gs` (後端)**：
     - 點擊左側檔案清單中的 `Code.gs`。
     - 清空內容，將本專案的 `Code.gs` 完整複製貼上。
     - 存檔 (Ctrl+S)。

   - **`Index.html` (前端)**：
     - 點擊左上角 `+` 號 > `HTML`。
     - 命名為 `Index` (注意大小寫)。
     - 清空內容，將本專案的 `Index.html` 完整複製貼上。
     - 存檔 (Ctrl+S)。

### 3. 部署為網頁應用程式 (重要！)
   1. 點擊右上角藍色的 **「部署」** > **「新建部署」**。
   2. 點選左側齒輪 > **「網頁應用程式」**。
   3. 設定如下：
      - **說明**：(隨意輸入，例如 v1)
      - **執行身分 (Execute as)**：選擇 **「我 (Me)」**。
      - **誰可以存取 (Who has access)**：選擇 **「所有人 (Anyone)」**。
        - *注意：一定要選所有人，員工才能在不登入 Google 的狀況下(如手機)打卡。*
   4. 點擊 **「部署」**。
   5. 核對權限 > 選擇帳號 > 進階 >前往 (不安全) > 允許。
   6. **複製產生的網址 (Web App URL)**，這就是給員工的打卡連結。

## 三、 使用方法

### 給員工 (使用者)
1. **開啟連結**：使用瀏覽器 (手機/電腦) 開啟您發布的網址。
2. **上班簽到**：
   - 輸入「姓名」。
   - 輸入「備註」(可選)。
   - 點擊綠色的 **[上班簽到]** 按鈕。
   - *系統會檢查當日是否已簽到，避免重複。*
3. **下班簽退**：
   - 輸入「姓名」。
   - 點擊紅色的 **[下班簽退]** 按鈕。
   - *系統會更新當日的簽退時間。*
4. **查詢紀錄**：下方表格會顯示歷史打卡資料。
5. **匯出報表**：點擊 **[匯出 PDF]** 按鈕，即可下載當前表格的 PDF 檔。

### 給管理員
- **查看資料**：所有打卡紀錄都會即時寫入您原本建立的 Google 試算表中。
- **修改資料**：若員工打錯卡，您可以直接在試算表中修正資料，前端頁面重新整理後會同步顯示修正後的結果。

## 常見問題 (Q&A)

- **Q: 為什麼顯示「找不到今日簽到紀錄」？**
  - A: 簽退時，系統會比對「姓名」與「日期」。請確認輸入的姓名與簽到時完全一致 (包含前後空白)。

- **Q: 如何修改程式碼？**
  - A: 修改 Apps Script 後，必須 **「重新部署」** > **「建立新版本」**，新的程式碼才會生效。若只按存檔，網頁版仍會停留在舊版。
